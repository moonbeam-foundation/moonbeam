# PR #8001: Structured Logging for Transaction Pool

## Overview

**PR Title:** `txpool`: use tracing for structured logging
**GitHub:** https://github.com/paritytech/polkadot-sdk/pull/8001
**Labels:** R0-no-crate-publish-required, T0-node
**Audience:** Node Dev
**Status:** Merged (April 22, 2025)

## Summary

This PR replaces the `log` crate with the `tracing` crate for structured logging in the transaction pool component (`sc-transaction-pool`). This is a follow-up to PR #6897 and resolves issue #5490.

## Changes

### Affected Crates
- `sc-transaction-pool` (minor bump)

### Technical Details
The PR converts all logging calls in the transaction pool from the `log` crate to the `tracing` crate, enabling structured logging with proper field syntax (e.g., `tx_hash = ?hash`). This provides better observability and filtering capabilities for node operators.

**Modified files include:**
- `substrate/client/transaction-pool/src/builder.rs`
- `substrate/client/transaction-pool/src/common/api.rs`
- `substrate/client/transaction-pool/src/common/enactment_state.rs`
- `substrate/client/transaction-pool/src/common/log_xt.rs` (deleted)
- `substrate/client/transaction-pool/src/common/metrics.rs`
- `substrate/client/transaction-pool/src/graph/` (multiple files)
- Various test files

### API Changes
**None.** This is purely an internal implementation change with no public API modifications.

## Impact on Moonbeam

**Impact Level: INHERITED**

### Analysis

1. **Moonbeam's Transaction Pool Usage**
   - Moonbeam uses `sc-transaction-pool` as a standard dependency (see `/Users/manuelmauro/Workspace/moonbeam/node/service/Cargo.toml:72`)
   - The transaction pool is built using `sc_transaction_pool::Builder::new()` with standard configuration
   - No custom transaction pool implementation or extensions

2. **Logging Infrastructure Compatibility**
   - Moonbeam already uses `sc-tracing` for its logging infrastructure
   - Uses tracing-aware macros: `#[sc_tracing::logging::prefix_logs_with("ðŸŒ—")]`
   - The change from `log` to `tracing` in sc-transaction-pool integrates seamlessly with existing infrastructure

3. **No Action Required**
   - This is an internal implementation detail of `sc-transaction-pool`
   - The change is transparent to users of the transaction pool
   - Structured logging will work automatically with Moonbeam's existing tracing setup

### Code Evidence

**Moonbeam's transaction pool initialization:**
```rust
// node/service/src/lib.rs:558
let transaction_pool = sc_transaction_pool::Builder::new(
    task_manager.spawn_essential_handle(),
    client.clone(),
    config.role.is_authority().into(),
)
.with_options(config.transaction_pool.clone())
.with_prometheus(config.prometheus_registry())
.build();
```

**Moonbeam's tracing usage:**
```rust
// node/service/Cargo.toml:71
sc-tracing = { workspace = true }

// node/service/src/lib.rs:668
#[sc_tracing::logging::prefix_logs_with("ðŸŒ—")]
```

### Benefits
- Enhanced observability: Transaction pool logs will use structured fields for better filtering and analysis
- Better debugging: Structured logs make it easier to correlate transaction pool events
- Consistent logging: Aligns with the broader Substrate ecosystem's migration to `tracing`

## Recommendation

**No action required.** This change will be automatically inherited when Moonbeam upgrades to stable2506. The improved structured logging will enhance node operator experience without requiring any code changes.

## References

- PRDoc: `/Users/manuelmauro/.substrate-mcp/moonbeam/releases/stable2506/pr-docs/pr_8001.prdoc`
- Moonbeam transaction pool usage: `/Users/manuelmauro/Workspace/moonbeam/node/service/src/lib.rs`
- Moonbeam tracing setup: `/Users/manuelmauro/Workspace/moonbeam/node/service/Cargo.toml`
