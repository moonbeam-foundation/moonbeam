# PR Analysis: #8103 - [pallet-revive] Add genesis config

## PR Metadata
- **GitHub URL**: https://github.com/paritytech/polkadot-sdk/pull/8103
- **Merged**: April 16, 2025
- **Labels**: R0-no-crate-publish-required, T7-smart_contracts
- **Audience**: Runtime Dev
- **Crate**: pallet-revive (patch bump)

## Summary

This PR adds genesis configuration support to `pallet-revive`, enabling initialization of mapped accounts during chain genesis. The changes include:

1. Added `GenesisConfig` struct with `mapped_accounts` field
2. Implemented `BuildGenesisConfig` trait for genesis initialization
3. Made `is_eth_derived` function public for external use
4. Enhanced strace logging to include gas consumption metrics
5. Updated kitchensink runtime to demonstrate usage with dev accounts

## Technical Changes

### Modified Files

**substrate/frame/revive/src/lib.rs** (20 changes)
- Added `GenesisConfig` struct:
  ```rust
  pub struct GenesisConfig {
      pub mapped_accounts: Vec<AccountId>
  }
  ```
- Implemented `BuildGenesisConfig` to initialize mapped accounts during genesis
- Exported `is_eth_derived` function in public API

**substrate/frame/revive/src/address.rs** (27 changes)
- Made `is_eth_derived` function public and standalone
- Refactored from `Self::is_eth_derived` to `is_eth_derived`

**substrate/frame/revive/proc-macro/src/lib.rs** (4 changes)
- Enhanced strace logging format to include gas consumption metrics

**substrate/bin/node/runtime/src/genesis_config_presets.rs** (4 changes)
- Added revive initialization in kitchensink genesis:
  ```rust
  revive: ReviveConfig {
      mapped_accounts: endowed_accounts.iter()
          .filter(|x| !is_eth_derived(x))
          .cloned()
          .collect()
  }
  ```

## Impact on Moonbeam

**Impact Level**: INHERITED

**Reasoning**:

Moonbeam does **not use** `pallet-revive` and therefore is not directly affected by this PR. Evidence:

1. **No pallet-revive dependency**: Grepping the Moonbeam codebase shows no usage of `pallet-revive` or `pallet_revive` in any runtime Cargo.toml files.

2. **Different smart contract approach**: Moonbeam uses an EVM-based smart contract system via `pallet-evm` and `pallet-ethereum`, as evidenced by the runtime configuration:
   ```rust
   // From runtime/moonbeam/src/lib.rs
   construct_runtime! {
       // ...
       EVM: pallet_evm::{Pallet, Config<T>, Call, Storage, Event<T>} = 51,
       Ethereum: pallet_ethereum::{Pallet, Call, Storage, Event, Origin, Config<T>} = 52,
       // ...
   }
   ```

3. **Architectural difference**: `pallet-revive` is a WASM-based smart contract pallet (successor to pallet-contracts), while Moonbeam is specifically designed as an Ethereum-compatible parachain using native EVM execution.

4. **TypeScript types**: The only mentions of "revive" in the Moonbeam codebase are in TypeScript type definitions (`ContractReviveProjectInfo`, `ContractReviveProjectSource`) which are auto-generated type definitions for contract metadata formats, not actual usage of the pallet.

## Action Required

**None**. This PR only affects chains that use `pallet-revive`. Since Moonbeam uses a completely different smart contract execution model (EVM-based rather than WASM-based), these changes have no impact on Moonbeam's functionality.

The changes will be inherited automatically as part of the Polkadot SDK upgrade, but require no code changes, configuration updates, or migration logic in the Moonbeam codebase.

## Testing Notes

No testing required for Moonbeam as the pallet is not used.

## References

- **PR**: https://github.com/paritytech/polkadot-sdk/pull/8103
- **Diff**: https://github.com/paritytech/polkadot-sdk/pull/8103/files
- **PRDoc**: /Users/manuelmauro/.substrate-mcp/moonbeam/releases/stable2506/pr-docs/pr_8103.prdoc
