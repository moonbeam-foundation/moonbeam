# PR #8179: Do Not Make pallet-identity Benchmarks Signature-Dependent

## Impact Level: MUST

## Summary

PR #8179 introduces a breaking change to `pallet-identity` by adding a new `BenchmarkHelper` configuration item. This change makes benchmarks signature-agnostic, abstracting away the explicit link with the Sr25519 signature schema. This allows chains using different signature schemes to run benchmarks and calculate weights properly.

## Changes Required

All three Moonbeam runtimes use `pallet-identity` and require the following addition to their Config implementations:

```rust
#[cfg(feature = "runtime-benchmarks")]
type BenchmarkHelper = ();
```

## Affected Files

The following runtime Config implementations need to be updated:

1. `/Users/manuelmauro/Workspace/moonbeam/runtime/moonbeam/src/lib.rs` (line ~629)
2. `/Users/manuelmauro/Workspace/moonbeam/runtime/moonriver/src/lib.rs` (line ~636)
3. `/Users/manuelmauro/Workspace/moonbeam/runtime/moonbase/src/lib.rs` (line ~637)

## Technical Details

### Current Implementation (Example from moonbeam)

```rust
impl pallet_identity::Config for Runtime {
    type RuntimeEvent = RuntimeEvent;
    type Currency = Balances;
    type BasicDeposit = ConstU128<{ currency::deposit(1, 258) }>;
    type ByteDeposit = ConstU128<{ currency::deposit(0, 1) }>;
    type SubAccountDeposit = ConstU128<{ currency::deposit(1, 53) }>;
    type MaxSubAccounts = MaxSubAccounts;
    type IdentityInformation = pallet_identity::legacy::IdentityInfo<MaxAdditionalFields>;
    type MaxRegistrars = MaxRegistrars;
    type Slashed = Treasury;
    type ForceOrigin = IdentityForceOrigin;
    type RegistrarOrigin = IdentityRegistrarOrigin;
    type OffchainSignature = Signature;
    type SigningPublicKey = <Signature as sp_runtime::traits::Verify>::Signer;
    type UsernameAuthorityOrigin = EnsureRoot<AccountId>;
    type PendingUsernameExpiration = PendingUsernameExpiration;
    type MaxSuffixLength = MaxSuffixLength;
    type MaxUsernameLength = MaxUsernameLength;
    type WeightInfo = moonbeam_weights::pallet_identity::WeightInfo<Runtime>;
    type UsernameDeposit = ConstU128<{ currency::deposit(0, MaxUsernameLength::get()) }>;
    type UsernameGracePeriod = ConstU32<{ 30 * DAYS }>;
}
```

### Required Addition

Add this line to each Config implementation:

```rust
impl pallet_identity::Config for Runtime {
    // ... existing config items ...
    #[cfg(feature = "runtime-benchmarks")]
    type BenchmarkHelper = ();
}
```

## Why This Is Required

1. **Breaking Change**: The pallet-identity crate received a major version bump, indicating a breaking API change
2. **Compilation Requirement**: Without this configuration, builds with the `runtime-benchmarks` feature will fail
3. **Benchmark Compatibility**: The default implementation `()` uses the Sr25519 signature schema, maintaining backward compatibility with Moonbeam's current signature setup
4. **All Runtimes Affected**: All three Moonbeam runtimes (moonbeam, moonriver, moonbase) include `pallet-identity` in their construct_runtime! macro

## Verification

After applying the changes:

1. Build with runtime-benchmarks feature:
   ```bash
   cargo build --release --features runtime-benchmarks
   ```

2. Run identity benchmarks to ensure they execute correctly:
   ```bash
   ./scripts/run-benches-for-runtime.sh moonbase release
   ```

## Additional Context

- PR was merged on June 5, 2025
- This change follows a similar pattern introduced in PR #4756 for `pallet-nfts`
- The default `()` implementation maintains the existing Sr25519 behavior
- Custom implementations can be provided for chains using different signature schemes

## References

- PR: https://github.com/paritytech/polkadot-sdk/pull/8179
- PRDoc: /Users/manuelmauro/.substrate-mcp/moonbeam/releases/stable2506/pr-docs/pr_8179.prdoc
