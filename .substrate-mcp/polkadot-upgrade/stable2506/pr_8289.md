# PR #8289 Analysis: Extract create_pool_with_native_on macro to common crate

## PR Metadata

- **PR Number**: [#8289](https://github.com/paritytech/polkadot-sdk/pull/8289)
- **Title**: Extract create_pool_with_native_on macro to common crate
- **Audience**: Runtime Dev
- **Release**: stable2506
- **Analysis Date**: 2025-10-22

## Overview

This PR extracts a test helper macro called `create_pool_with_native_on` from the `bridge-hub-westend-integration-tests` crate and moves it to the `emulated-integration-tests-common` crate to enable reuse across multiple runtime repositories.

## Changes Summary

### Affected Crates

1. **bridge-hub-westend-integration-tests** (patch bump)
   - The macro was removed from this crate

2. **emulated-integration-tests-common** (minor bump)
   - The macro was added to this common crate at `cumulus/parachains/integration-tests/emulated/common/src/macros.rs`

### Macro Purpose

The `create_pool_with_native_on` macro is a test helper that:
- Creates liquidity pools for asset conversion testing
- Calls the AssetConversion pallet to initialize pools with native and other assets
- Is used in emulated integration tests for parachain runtimes

## Impact on Moonbeam

### Direct Impact: NONE

**Sentiment: INHERITED**

### Analysis

This PR has **NO IMPACT** on Moonbeam for the following reasons:

1. **Moonbeam does not use these crates**
   - `bridge-hub-westend-integration-tests` is NOT a dependency
   - `emulated-integration-tests-common` is NOT a dependency
   - These are test infrastructure crates specifically for Polkadot SDK's internal integration testing

2. **Crate verification**
   ```bash
   # Search across all Cargo.toml files in Moonbeam
   $ rg "bridge-hub-westend-integration-tests|emulated-integration-tests-common" --type toml
   # Result: No matches found
   ```

3. **Macro usage verification**
   ```bash
   # Search for the macro in Moonbeam codebase
   $ rg "create_pool_with_native_on"
   # Result: Only found in upgrade tracking documentation, not in actual code
   ```

4. **Related bridge functionality**
   - Moonbeam DOES use `bp-bridge-hub-cumulus` and `bridge-hub-common` for bridge functionality
   - However, these are runtime/pallet crates, NOT test infrastructure crates
   - The affected crates in this PR are purely for emulated integration testing

### Moonbeam's Test Infrastructure

Moonbeam uses a different testing approach:
- **Rust unit tests**: In each pallet/module using standard test macros
- **TypeScript integration tests**: Using the Moonwall framework in the `/test` directory
- **Does NOT use**: Polkadot SDK's emulated integration test framework

## Conclusion

This is a pure refactoring PR that reorganizes test infrastructure code within the Polkadot SDK repository. Since Moonbeam:
1. Does not depend on either affected crate
2. Does not use the Polkadot SDK emulated integration test framework
3. Does not reference the moved macro anywhere in its codebase

**This PR requires NO ACTION from the Moonbeam team.**

### Classification
- **Impact Level**: INHERITED (changes come through dependency updates but have no functional impact)
- **Action Required**: None
- **Migration Required**: No
- **Testing Required**: No
- **Documentation Required**: No

## Additional Notes

- This is a typical code reuse refactoring to reduce duplication across test suites
- The minor version bump on `emulated-integration-tests-common` indicates a backward-compatible addition
- The patch bump on `bridge-hub-westend-integration-tests` reflects the removal of duplicate code
- No breaking changes, no API changes that affect downstream consumers
