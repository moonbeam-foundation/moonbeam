# PR #8345: tx/metrics: Add metrics for the RPC v2 `transactionWatch_v1_submitAndWatch`

**Impact**: INHERITED
**Confidence**: High
**Affected Components**: None directly affected

## Changes Detected

This PR introduces metrics for the RPC v2 `transactionWatch_v1_submitAndWatch` subscription endpoint. The changes include:

1. **Metrics Module**: Added metrics tracking for transaction events
   - Simple counters for global event counts
   - Histogram vectors measuring execution times labeled by initial and final transaction events

2. **Crate Bumps**:
   - `sc-service`: bumped as major
   - `sc-rpc-spec-v2`: bumped as major

3. **Purpose**:
   - Help identify transaction pool event progression times
   - Enable better debugging of transaction state changes
   - Part of issue #8336 (Introduce Transaction Metrics on RPC-level)

## Project Impact

**No direct impact on Moonbeam codebase.**

While Moonbeam uses `sc-service` as a dependency (`/Users/manuelmauro/Workspace/moonbeam/node/service/Cargo.toml:68`), the changes in this PR are purely additive:

1. **sc-service usage in Moonbeam**: The crate is used extensively for node service configuration, task spawning, and network building in:
   - `/Users/manuelmauro/Workspace/moonbeam/node/service/src/lib.rs`
   - `/Users/manuelmauro/Workspace/moonbeam/node/service/src/chain_spec/*.rs`
   - `/Users/manuelmauro/Workspace/moonbeam/node/service/src/lazy_loading/*.rs`

2. **sc-rpc-spec-v2 usage**: This crate is **not directly imported** by Moonbeam. It exists as a transitive dependency through `sc-service`, but Moonbeam does not directly use RPC v2 spec functionality.

3. **Nature of changes**: The PR adds internal metrics infrastructure for a specific RPC v2 endpoint (`transactionWatch_v1_submitAndWatch`). This is:
   - A purely internal observability feature
   - Does not change any public API surfaces
   - Does not modify existing functionality
   - Only adds new optional metrics exposure

4. **RPC Implementation**: Moonbeam's RPC setup (`/Users/manuelmauro/Workspace/moonbeam/node/service/src/rpc.rs`) uses Frontier's Ethereum-compatible RPC layer (fc-rpc) which provides Ethereum JSON-RPC methods, not the Substrate RPC v2 spec endpoints.

## Evidence & References

### Dependency Check
```
/Users/manuelmauro/Workspace/moonbeam/node/service/Cargo.toml:68:sc-service = { workspace = true }
/Users/manuelmauro/Workspace/moonbeam/node/cli/Cargo.toml:23:sc-service = { workspace = true }
```

### sc-rpc-spec-v2 Not Directly Used
```bash
# Search results show sc-rpc-spec-v2 only exists in:
# - Cargo.lock (transitive dependency)
# - workspace Cargo.toml (workspace definition)
# No direct imports or usage found in Moonbeam's code
```

### Moonbeam RPC Implementation
Moonbeam uses Frontier RPC layer exclusively:
- `/Users/manuelmauro/Workspace/moonbeam/node/service/src/rpc.rs:173-176` - Uses fc-rpc's Eth, EthFilter, EthPubSub, etc.
- Does not use Substrate RPC v2 spec endpoints like `transactionWatch_v1_submitAndWatch`

### Version Information
- `sc-service` v0.52.0 from moonbeam-polkadot-stable2506
- `sc-rpc-spec-v2` v0.51.0 from moonbeam-polkadot-stable2506

## Conclusion

This PR's changes are **INHERITED** automatically through dependency updates with no action required from Moonbeam developers. The new metrics functionality is opt-in observability tooling that does not affect Moonbeam's operation, as Moonbeam does not use the RPC v2 spec endpoints that gained metrics tracking. The major version bumps on these crates reflect internal additions rather than breaking API changes affecting downstream consumers.
