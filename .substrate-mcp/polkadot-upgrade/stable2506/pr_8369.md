# PR #8369: Sync xcm related test utils impls with runtimes repo

**Impact**: INHERITED
**Confidence**: High
**Affected Components**: None (test utilities only)

## Changes Detected

This PR synchronizes XCM-related test utilities between the Polkadot SDK and the Runtimes repository. The changes include:

1. **Modified test macros for trusted teleporter scenarios:**
   - `test_parachain_is_trusted_teleporter`
   - `test_relay_is_trusted_teleporter`
   - `test_parachain_is_trusted_teleporter_for_relay`

2. **Updated to utilize "dry-run" functionality in test scenarios**

3. **Modified `ToParachainDeliveryHelper`** to use `WithdrawAsset` for worst-case fee estimation instead of `ClearOrigin`

## Project Impact

**No Direct Impact on Moonbeam**

After comprehensive analysis of the Moonbeam codebase, this PR has no impact on the project:

### Test Macros Not Used
The modified test macros (`test_parachain_is_trusted_teleporter`, etc.) are **not used anywhere** in the Moonbeam codebase:
- Search across all `.rs` files found zero references
- Moonbeam uses `xcm_simulator` for XCM testing but does not use these specific test utility macros

### ToParachainDeliveryHelper Not Used
The `ToParachainDeliveryHelper` helper is **not referenced** in the Moonbeam codebase:
- No occurrences found in any source files
- This is an internal test utility from `assets-common` that Moonbeam doesn't depend on

### Moonbeam's XCM Testing Approach
Moonbeam uses its own XCM testing infrastructure:
- Custom test setup in `/runtime/{moonbase,moonriver,moonbeam}/tests/xcm_mock/`
- Uses `xcm_simulator` directly with custom parachain and relay chain mocks
- Does not depend on `assets-common` test utilities or polkadot-test-runtime helpers

### Dry-Run API (Unrelated)
The PR mentions "dry-run" functionality, but this refers to test execution, not the runtime `DryRunApi`:
- Moonbeam already implements `xcm_runtime_apis::dry_run::DryRunApi` in `/runtime/common/src/apis.rs:759-777`
- This is unrelated to the test macro changes in PR #8369
- The runtime API remains unchanged by this PR

## Evidence & References

### Search Results
```bash
# Test macros not found
grep -r "test_parachain_is_trusted_teleporter\|test_relay_is_trusted_teleporter\|test_parachain_is_trusted_teleporter_for_relay" /Users/manuelmauro/Workspace/moonbeam
# Result: No matches found

# ToParachainDeliveryHelper not found
grep -r "ToParachainDeliveryHelper" /Users/manuelmauro/Workspace/moonbeam
# Result: No matches found

# assets-common or polkadot-test-runtime not in dependencies
grep -r "assets.common\|polkadot.test" /Users/manuelmauro/Workspace/moonbeam/Cargo.toml /Users/manuelmauro/Workspace/moonbeam/runtime/*/Cargo.toml
# Result: No matches found
```

### Moonbeam's XCM Test Structure
Files confirming Moonbeam uses custom test infrastructure:
- `/Users/manuelmauro/Workspace/moonbeam/runtime/moonbase/tests/xcm_mock/mod.rs:24` - Uses `xcm_simulator::{decl_test_network, decl_test_parachain, decl_test_relay_chain, TestExt}`
- `/Users/manuelmauro/Workspace/moonbeam/runtime/moonriver/tests/xcm_mock/mod.rs` - Similar custom setup
- `/Users/manuelmauro/Workspace/moonbeam/runtime/moonbeam/tests/xcm_mock/mod.rs` - Similar custom setup

### Runtime DryRunApi (Unaffected)
Moonbeam's DryRunApi implementation at:
- `/Users/manuelmauro/Workspace/moonbeam/runtime/common/src/apis.rs:759-777`
- `/Users/manuelmauro/Workspace/moonbeam/runtime/moonbase/src/lib.rs:130` - Imports dry_run types
- `/Users/manuelmauro/Workspace/moonbeam/runtime/moonriver/src/lib.rs:116` - Imports dry_run types
- `/Users/manuelmauro/Workspace/moonbeam/runtime/moonbeam/src/lib.rs:111` - Imports dry_run types

This is a runtime API for executing calls/XCM dry-run, completely separate from the test utilities modified in this PR.

## Conclusion

This PR modifies test utility macros that Moonbeam does not use. The changes are **INHERITED** automatically without requiring any code changes. Moonbeam's XCM testing uses a different approach with custom `xcm_simulator`-based mocks, and the project does not depend on the affected `assets-common` test helpers.

No action required.
