# PR #8630: Broker: Introduce min price and adjust renewals to lower market

**Impact**: INHERITED
**Confidence**: High
**Affected Components**: None (indirect dependency only)

## Changes Detected

This PR introduces two improvements to `pallet-broker` (the coretime marketplace):

1. **New MinimumPrice adapter**: A new `AdaptPrice` implementation that works like `CenterTargetPrice` but enforces a configurable minimum price floor. If set, it prevents the `end_price` and `target_price` from dropping below the minimum.

2. **Adjusted renewal pricing**: Renewal prices are now coupled to market conditions - they are set to either the renewal bump or the current sale's `end_price`, whichever is higher. This prevents renewals from becoming too detached from current market rates.

These changes affect:
- `pallet-broker` (minor bump to 0.20.0)
- `coretime-rococo-runtime` (minor bump)
- `coretime-westend-runtime` (minor bump)

## Project Impact

**No direct impact on Moonbeam**. The broker pallet is NOT used in any Moonbeam runtime configuration.

### Dependency Analysis

While `pallet-broker` appears in Moonbeam's `Cargo.lock`, it is only a **transitive dependency** that comes through this chain:

```
pallet-broker
  └─ polkadot-runtime-common (relay chain runtime common utilities)
      └─ cumulus-pallet-xcmp-queue (used by Moonbeam)
```

The broker pallet is used by relay chain runtimes (Westend, Rococo) for their coretime marketplace functionality. Moonbeam, as a parachain, uses XCM-related Cumulus pallets that depend on `polkadot-runtime-common`, which in turn includes broker functionality for the relay chains.

### Verification in Moonbeam Runtimes

Checked all three Moonbeam runtimes:
- `/Users/manuelmauro/Workspace/moonbeam/runtime/moonbase/src/lib.rs` - NO broker pallet configured
- `/Users/manuelmauro/Workspace/moonbeam/runtime/moonriver/src/lib.rs` - NO broker pallet configured
- `/Users/manuelmauro/Workspace/moonbeam/runtime/moonbeam/src/lib.rs` - NO broker pallet configured

None of the runtimes include broker in their `construct_runtime!` macro, and no code references `pallet_broker`, `AdaptPrice`, `CenterTargetPrice`, or `MinimumPrice`.

## Evidence & References

### Cargo Dependency Tree
```
$ cargo tree -i pallet-broker
pallet-broker v0.20.0
├── polkadot-runtime-common v20.0.0
│   ├── cumulus-pallet-xcmp-queue v0.21.0
│   │   ├── moonbase-runtime v0.8.4
│   │   ├── moonbeam-runtime v0.8.4
│   │   └── moonriver-runtime v0.8.4
```

### Grep Results
- Search for `pallet-broker|pallet_broker` in codebase: Only found in `Cargo.lock` (transitive dependency)
- Search for `AdaptPrice|CenterTargetPrice|MinimumPrice`: No matches in Moonbeam code
- Search for "broker" in runtime Cargo.toml files: No direct dependencies

### Runtime Configuration
Examined `construct_runtime!` blocks in all three runtimes (moonbase line 1410, moonriver, moonbeam) - none include a Broker pallet.

## Conclusion

This PR's changes are **automatically inherited** through the Polkadot SDK upgrade but have **no functional impact** on Moonbeam. The broker pallet exists in the dependency tree solely because Cumulus pallets depend on `polkadot-runtime-common` (which includes relay chain functionality).

**No action required** from Moonbeam developers.
