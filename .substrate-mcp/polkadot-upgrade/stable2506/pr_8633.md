# PR #8633: Staking (EPMB): update the semantics of elect() and Phase::Extract(N)

**Impact**: INHERITED
**Confidence**: High
**Affected Components**: None

## Changes Detected

This PR updates the internal semantics of `pallet-election-provider-multi-block` (EPMB):

- Makes `elect()` solely responsible for `Phase::Export` transitions
- Updates the semantics of `elect(N)` and `Export(N)` phase handling
- Fixes issue where multiple transactions were handled in the same block when staking-async pallet was initialized before EPMB

Previously, phase transition handling was split between EPMB's `on_initialize()`/`next()` and `elect()` (triggered by staking-async's `on_initialize()`). Now all phase transitions are unified under `elect()`.

Example flow for a 4-page election:
- `elect(3)`: If in Done, serve result for page 3, transition to Export(2)
- `elect(2)`: If in Export(2), serve result for page 2, transition to Export(1)
- `elect(1)`: If in Export(1), serve result for page 1, transition to Export(0)
- `elect(0)`: If in Export(0), serve result for page 0, transition to Off

**Crate Bumped**: `pallet-election-provider-multi-block` (major)

## Project Impact

**No impact on Moonbeam.**

Moonbeam does not use `pallet-election-provider-multi-block` or the Substrate staking system. The changes are internal to relay chain staking mechanics and do not affect parachain functionality.

## Evidence & References

### Search Results

1. **No EPMB dependency in runtime Cargo.toml files**:
   - Searched all runtime Cargo.toml files: moonbase, moonbeam, moonriver, common, relay-encoder, evm_tracer
   - No references to `pallet-election-provider-multi-block` or `election-provider-multi-block`

2. **No EPMB usage in pallets**:
   - Searched all custom pallet directories
   - No references to election provider pallets found

3. **Staking references are only for XCM relay encoding**:
   - `/Users/manuelmauro/Workspace/moonbeam/runtime/relay-encoder/src/polkadot.rs`
   - `/Users/manuelmauro/Workspace/moonbeam/runtime/relay-encoder/src/kusama.rs`
   - `/Users/manuelmauro/Workspace/moonbeam/runtime/relay-encoder/src/westend.rs`
   - These files encode relay chain staking calls for XCM transactor functionality (remote staking via XCM)
   - They reference `pallet_staking::RewardDestination` and `pallet_staking::ValidatorPrefs` types for encoding purposes only
   - No actual staking pallet instantiation or election provider usage

4. **Moonbeam uses custom staking**:
   - Moonbeam has its own `pallet-parachain-staking` for collator/delegator staking
   - Does not use Substrate's validator election or staking system

### Conclusion

This PR modifies internal phase transition mechanics in a relay chain-specific pallet. Since Moonbeam:
- Does not instantiate `pallet-election-provider-multi-block`
- Does not use the Substrate staking system
- Only encodes relay chain staking calls for XCM purposes (not affected by EPMB changes)

The changes will be inherited automatically through the Polkadot SDK upgrade with zero impact on Moonbeam's functionality.

## References

- PR: https://github.com/paritytech/polkadot-sdk/pull/8633
- Pallet: `pallet-election-provider-multi-block`
- Audience: Runtime Dev
- Bump: Major
