# PR #8667: revive: Simplify the storage meter

**Impact**: INHERITED
**Confidence**: High
**Affected Components**: None (pallet-revive not used in Moonbeam)

## Changes Detected

This PR simplifies the storage deposit mechanism in `pallet-revive`, the PolkaVM-based smart contract pallet. Key changes include:

1. **Decoupled storage meter limits from origin balance**: Root storage meter and nested meters' limits are now completely independent of the origin's balance
2. **Consistent error handling**:
   - `StorageDepositNotEnoughFunds`: Used when limit is not reached
   - `StorageDepositLimitExhausted`: Used when limit is reached
3. **ED handling change**: Origin unable to pay existential deposit now results in `StorageDepositNotEnoughFunds` and traps the caller (instead of `TransferFailed` return code)

## Project Impact

**No impact on Moonbeam.**

Moonbeam uses `pallet-evm` (Frontier) for Ethereum-compatible smart contract execution, not `pallet-revive`. The `pallet-revive` crate is present in Cargo.lock as a transitive dependency from the Polkadot SDK fork, but is not directly imported or used by any Moonbeam runtime or node component.

## Evidence & References

### Codebase Search Results

1. **pallet-revive not used in any Cargo.toml**:
   - Searched all Cargo.toml files in the project
   - No direct dependency on `pallet-revive` found
   - Only appears in Cargo.lock as transitive dependency

2. **Moonbeam uses pallet-evm instead**:
   - `/Users/manuelmauro/Workspace/moonbeam/runtime/moonbase/Cargo.toml`: Lines 133-139 show pallet-evm usage
   - `/Users/manuelmauro/Workspace/moonbeam/runtime/moonbeam/Cargo.toml`: Similar pallet-evm dependencies
   - `/Users/manuelmauro/Workspace/moonbeam/runtime/moonriver/Cargo.toml`: Similar pallet-evm dependencies

3. **No usage of revive-specific error codes**:
   - `StorageDepositNotEnoughFunds`: 0 matches in codebase
   - `StorageDepositLimitExhausted`: 0 matches in codebase

### PR Details

- **PR URL**: https://github.com/paritytech/polkadot-sdk/pull/8667
- **Audience**: Runtime Dev
- **Crate**: pallet-revive (patch bump)
- **Purpose**: Preparation for [contract-issues#38](https://github.com/paritytech/contract-issues/issues/38)

### Conclusion

This PR only affects projects using `pallet-revive` for smart contracts. Since Moonbeam is an Ethereum-compatible parachain using `pallet-evm` from the Frontier framework, these changes have no functional impact. The update will be inherited automatically through the Polkadot SDK upgrade without requiring any code changes in Moonbeam.
